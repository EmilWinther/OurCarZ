@page
@model OurCarZ.Pages.EditRouteModel
@{
    ViewData["Title"] = "Edit Profile Page for User";
}

@if (Model.YourRoute != null)
{
    <h2>Current Route Details: </h2>
    <p>From: @Model.StartAddress.RoadName</p>
    <p> via: </p>
        @foreach (var passenger in Model.PassengerList.Take(Model.YourCar.Seats))
        {
            @foreach (var address in Model.AddressList)
            {
                if (address.AddressId.Equals(passenger.Via))
                {
                    <p>@address.RoadName @address.ZipCode</p>
                }
            }
        }
    <p>To: @Model.EndAddress.RoadName </p>
    <p>Departure Time: @Model.YourRoute.StartTime.TimeOfDay </p>
    <p>Arrival Time: @Model.YourRoute.ArrivalTime.Value.TimeOfDay </p>
    <p>Seats available: @Model.YourCar.Seats</p>
    if (Model.YourRoute.ArrivalTime.Value.Date != Model.YourRoute.StartTime.Date)
    {
        <p>Date: Route error, Arrival date and Start date is not the same</p>
    }
    else
    {
        <p>Date: @Model.RouteDate</p>
    }

    <form method="post">
        <h2>Change the Route details: </h2>
        <div class="form-group">
            <label for="start">Start Address:</label>
            <input type="text" id="@Model.Start" name="start">
            <span asp-validation-for="Start" class="text-danger"></span><br><br>
        </div>
        <div class="form-group">
            <label for="end">End Address:</label>
            <input type="text" id="@Model.End" name="end">
            <span asp-validation-for="End" class="text-danger"></span><br><br>
        </div>
        <div class="form-group">
            <label for="starttime">Start Date and Time:</label>
            <input type="text" id="@Model.YourRoute.StartTime" name="starttime">
            <span asp-validation-for="YourRoute.StartTime" class="text-danger"></span><br><br>
            <p>Remember to write it like this example: 22-05-2021 13:00:00</p>
            <p><b>Dates have to be the same and arrival time should be later than start time</b></p>
        </div>
        <div class="form-group">
            <label for="arrivaltime">Arrival Date and Time:</label>
            <input type="text" id="@Model.YourRoute.ArrivalTime" name="arrivaltime">
            <span asp-validation-for="YourRoute.ArrivalTime" class="text-danger"></span><br><br>
            <p>Remember to write it like this example: 22-05-2021 13:00:00</p>
        </div>
        <div class="form-group">
            <label for="seats">number of Seats:</label>
            <input type="text" id="@Model.Seats" name="seats">
            <span asp-validation-for="Seats" class="text-danger"></span><br><br>
        </div>
        <!-- Hidden input field is used, for storing the UserId needed to find the user, since there is no persistence between OnGet() and OnPost() -->
        <input hidden="hidden" asp-for="@Model.YourRoute.RouteId" />
        <input type="submit" value="Submit" onclick="return confirm('Are you sure you want to change your information? remember to restart program')">
    </form>
}
else
{
    <p>Route can't be found!</p>
}
<br>
<br>
